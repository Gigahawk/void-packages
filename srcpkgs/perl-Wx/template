# Template file for 'perl-Wx'
pkgname=perl-Wx
version=0.9932
revision=1
wrksrc="Wx-${version}"
build_style=perl-module
#hostmakedepends="perl perl-ExtUtils-XSpp perl-Alien-wxWidgets wxWidgets-devel"
hostmakedepends="perl perl-ExtUtils-XSpp perl-Alien-wxWidgets"
makedepends="perl wxWidgets-devel"
depends="perl wxWidgets perl-Alien-wxWidgets perl-ExtUtils-XSpp"
#nocross="headers for wxWidgets-devel aren't found"
short_desc="Wx - interface to the wxWidgets cross-platform GUI toolkit"
maintainer="Jasper Chan <jasperchan515@gmail.com>"
license="Artistic-1.0-Perl, GPL-1.0-or-later"
homepage="https://metacpan.org/release/Wx"
distfiles="${CPAN_SITE}/Wx/${pkgname#perl-}-${version}.tar.gz"
checksum=1cfdb6535a0f4676e6f1aab2c9d8e16d577be3eb3b7cc04c8074d685e6651b70

do_build() {
	# Original do_build() doesn't seem to support C++ compilation

	sed -i -e "s;-I\(/usr/lib/wx/include/\);-I${XBPS_CROSS_BASE}\1;" \
	 -e "s;-I\(/usr/include/wx\);-I${XBPS_CROSS_BASE}\1;" \
	 Makefile

	make CC="$CXX" LD="$CXX" CFLAGS="$CXXFLAGS" OPTIMIZE="$CXXFLAGS" \
		LDFLAGS="$LDFLAGS -L${XBPS_CROSS_BASE}/usr/lib -lperl" \
		LDDLFLAGS="-shared $CFLAGS -L${XBPS_CROSS_BASE}/usr/lib -lperl" \
		${makejobs} ${make_build_args} ${make_build_target}
}
