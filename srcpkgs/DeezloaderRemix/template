# Template file for 'DeezloaderRemix'
pkgname=DeezloaderRemix
version=4.2.1
revision=1
wrksrc=deezloaderremix
hostmakedepends="git nodejs"
short_desc="Download MP3s and FLACs directly from Deezer Servers"
maintainer="Jasper Chan <jasperchan515@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://notabug.org/RemixDevs/DeezloaderRemix"
distfiles="https://notabug.org/RemixDevs/DeezloaderRemix/archive/${version}.tar.gz"
checksum=8469f2a6e23d478bf0938e518e8cabf1ddc47a37f780b0183ae5a3d2326bb896
nocross=yes
nostrip=yes
shlib_provides="libnode.so libffmpeg.so"

case "$XBPS_TARGET_MACHINE" in
	i686*) broken="/void-packages/srcpkgs/DeezloaderRemix/template: line 17:  1928 Segmentation fault" ;;
esac

do_build() {
	npm install
	npm run dist:linux
}

do_install() {
	vmkdir usr/lib/deezloaderremix
	vcopy dist/linux-unpacked/* /usr/lib/deezloaderremix/
	vlicense LICENSE
	vbin ${FILESDIR}/deezloader-rmx.sh deezloader-rmx
	vinstall ${FILESDIR}/deezloader-rmx.desktop 644 /usr/share/applications deezloader-rmx.desktop
}
